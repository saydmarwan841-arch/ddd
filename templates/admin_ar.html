<!DOCTYPE html>
<html lang="ar" dir="rtl">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… - Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        // ØªØ¹Ø·ÙŠÙ„ ØªØ­Ø°ÙŠØ±Ø§Øª Tailwind CSS ÙÙŠ Ø¨ÙŠØ¦Ø© Ø§Ù„ØªØ·ÙˆÙŠØ±
        if (window.tailwind) {
            window.tailwind.config = {
                corePlugins: {
                    preflight: true
                }
            };
        }
    </script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <style>
        html {
            direction: rtl;
        }

        body {
            background: linear-gradient(135deg, #fce7f3 0%, #fbcfe8 25%, #f9a8d4 50%, #f472b6 75%, #ec4899 100%);
            background-size: 400% 400%;
            animation: gradientShift 15s ease infinite;
            min-height: 100vh;
        }

        @keyframes gradientShift {
            0% {
                background-position: 0% 50%;
            }

            50% {
                background-position: 100% 50%;
            }

            100% {
                background-position: 0% 50%;
            }
        }

        .dashboard-card {
            backdrop-filter: blur(10px);
            background: rgba(255, 255, 255, 0.95);
            box-shadow: 0 8px 32px rgba(236, 72, 153, 0.2);
        }

        .stat-card {
            background: linear-gradient(135deg, #fce7f3 0%, #fbcfe8 100%);
            border: 2px solid rgba(236, 72, 153, 0.3);
        }

        .question-item {
            background: rgba(255, 255, 255, 0.9);
            border-left: 4px solid #ec4899;
        }

        .btn-primary {
            background: linear-gradient(135deg, #ec4899 0%, #f472b6 100%);
            transition: all 0.3s ease;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 16px rgba(236, 72, 153, 0.3);
        }

        .btn-danger {
            background: linear-gradient(135deg, #f43f5e 0%, #e11d48 100%);
            transition: all 0.3s ease;
        }

        .btn-danger:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 16px rgba(244, 63, 94, 0.3);
        }

        .btn-edit {
            background: linear-gradient(135deg, #3b82f6 0%, #1d4ed8 100%);
            transition: all 0.3s ease;
        }

        .btn-edit:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 16px rgba(59, 130, 246, 0.3);
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            z-index: 50;
            align-items: center;
            justify-content: center;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: white;
            border-radius: 1.5rem;
            padding: 2rem;
            max-width: 600px;
            width: 90%;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
        }

        input,
        textarea {
            transition: all 0.3s ease;
        }

        input:focus,
        textarea:focus {
            border-color: #ec4899 !important;
            box-shadow: 0 0 0 3px rgba(236, 72, 153, 0.1) !important;
        }

        .fade-in {
            animation: fadeIn 0.5s ease;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
            }

            to {
                opacity: 1;
            }
        }
    </style>
</head>

<body>
    <div class="min-h-screen py-8 px-4 sm:px-6 lg:px-8">
        <div class="max-w-6xl mx-auto">
            <!-- Ø±Ø£Ø³ Ø§Ù„ØµÙØ­Ø© -->
            <div class="flex flex-col sm:flex-row items-center justify-between mb-8 gap-4">
                <div>
                    <h1 class="text-4xl font-bold text-white drop-shadow-lg">ğŸ“Š Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…</h1>
                    <p class="text-pink-100 text-sm mt-1">Ø¥Ø¯Ø§Ø±Ø© Ø£Ø³Ø¦Ù„Ø© Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø­Ø¨ Ø§Ù„Ø±ÙˆÙ…Ø§Ù†Ø³ÙŠ</p>
                </div>
                <div class="flex gap-3">
                    <button id="addQuestionBtn" onclick="openAddModal()"
                        class="btn-primary text-white font-bold py-3 px-6 rounded-lg hover:shadow-lg">
                        â• Ø¥Ø¶Ø§ÙØ© Ø³Ø¤Ø§Ù„ Ø¬Ø¯ÙŠØ¯
                    </button>
                    <a href="/admin/logout"
                        class="bg-red-500 hover:bg-red-600 text-white font-bold py-3 px-6 rounded-lg transition">
                        ğŸšª ØªØ³Ø¬ÙŠÙ„ Ø®Ø±ÙˆØ¬
                    </a>
                </div>
            </div>

            <!-- Ø¨Ø·Ø§Ù‚Ø§Øª Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                <div class="stat-card rounded-lg p-6 text-center">
                    <p class="text-gray-600 text-sm font-medium mb-2">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø£Ø³Ø¦Ù„Ø©</p>
                    <p class="text-4xl font-bold text-pink-600" id="totalQuestions">0</p>
                </div>
                <div class="stat-card rounded-lg p-6 text-center">
                    <p class="text-gray-600 text-sm font-medium mb-2">Ø§Ù„ÙØ¦Ø§Øª</p>
                    <p class="text-4xl font-bold text-pink-600" id="totalCategories">0</p>
                </div>
                <div class="stat-card rounded-lg p-6 text-center">
                    <p class="text-gray-600 text-sm font-medium mb-2">Ø¢Ø®Ø± ØªØ­Ø¯ÙŠØ«</p>
                    <p class="text-lg font-bold text-pink-600" id="lastUpdated">Ø§Ù„Ø¢Ù†</p>
                </div>
            </div>

            <!-- Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø£Ø³Ø¦Ù„Ø© -->
            <div class="dashboard-card rounded-2xl p-8">
                <h2 class="text-2xl font-bold text-gray-800 mb-6">ğŸ“ Ø§Ù„Ø£Ø³Ø¦Ù„Ø©</h2>
                <div id="questionsContainer" class="space-y-4">
                    <div class="text-center py-12">
                        <p class="text-gray-500 text-lg">Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø£Ø³Ø¦Ù„Ø©...</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Ù†Ù…ÙˆØ°Ø¬ Ø¥Ø¶Ø§ÙØ©/ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø³Ø¤Ø§Ù„ -->
    <div id="questionModal" class="modal">
        <div class="modal-content fade-in">
            <h2 class="text-3xl font-bold text-gray-800 mb-6" id="modalTitle">Ø¥Ø¶Ø§ÙØ© Ø³Ø¤Ø§Ù„ Ø¬Ø¯ÙŠØ¯</h2>

            <form id="questionForm" onsubmit="handleFormSubmit(event)" class="space-y-6">
                <!-- Ù†ÙˆØ¹ Ø§Ù„Ø³Ø¤Ø§Ù„ -->
                <div>
                    <label class="block text-sm font-semibold text-gray-700 mb-2">Ù†ÙˆØ¹ Ø§Ù„Ø³Ø¤Ø§Ù„</label>
                    <select id="questionType" name="type" onchange="updateQuestionType()"
                        class="w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:outline-none" required>
                        <option value="">-- Ø§Ø®ØªØ± Ù†ÙˆØ¹ Ø§Ù„Ø³Ø¤Ø§Ù„ --</option>
                        <option value="mcq">Ø§Ø®ØªÙŠØ§Ø± Ù…Ù† Ù…ØªØ¹Ø¯Ø¯ (MCQ)</option>
                        <option value="tf">ØµØ­ / Ø®Ø·Ø£ (True/False)</option>
                    </select>
                </div>

                <!-- Ù†Øµ Ø§Ù„Ø³Ø¤Ø§Ù„ -->
                <div>
                    <label class="block text-sm font-semibold text-gray-700 mb-2">Ø§Ù„Ø³Ø¤Ø§Ù„</label>
                    <textarea id="questionText" name="question" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ù„Ø³Ø¤Ø§Ù„ Ù‡Ù†Ø§..."
                        class="w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:outline-none resize-none"
                        rows="3" required></textarea>
                </div>

                <!-- Ø­Ø§ÙˆÙŠØ© Ø§Ù„Ø®ÙŠØ§Ø±Ø§Øª (Ù…ØªØºÙŠØ±Ø© Ø­Ø³Ø¨ Ø§Ù„Ù†ÙˆØ¹) -->
                <div id="optionsContainer">
                    <!-- Ø§Ù„Ø®ÙŠØ§Ø± 1 -->
                    <div>
                        <label class="block text-sm font-semibold text-gray-700 mb-2">Ø§Ù„Ø®ÙŠØ§Ø± Ø§Ù„Ø£ÙˆÙ„</label>
                        <input type="text" id="option0" name="option0" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ù„Ø®ÙŠØ§Ø± Ø§Ù„Ø£ÙˆÙ„..."
                            class="w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:outline-none" required>
                    </div>

                    <!-- Ø§Ù„Ø®ÙŠØ§Ø± 2 -->
                    <div>
                        <label class="block text-sm font-semibold text-gray-700 mb-2">Ø§Ù„Ø®ÙŠØ§Ø± Ø§Ù„Ø«Ø§Ù†ÙŠ</label>
                        <input type="text" id="option1" name="option1" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ù„Ø®ÙŠØ§Ø± Ø§Ù„Ø«Ø§Ù†ÙŠ..."
                            class="w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:outline-none" required>
                    </div>

                    <!-- Ø§Ù„Ø®ÙŠØ§Ø± 3 (Ù…Ø®ÙÙŠ Ù„Ù„Ø£Ø³Ø¦Ù„Ø© True/False) -->
                    <div id="option2Container">
                        <label class="block text-sm font-semibold text-gray-700 mb-2">Ø§Ù„Ø®ÙŠØ§Ø± Ø§Ù„Ø«Ø§Ù„Ø«</label>
                        <input type="text" id="option2" name="option2" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ù„Ø®ÙŠØ§Ø± Ø§Ù„Ø«Ø§Ù„Ø«..."
                            class="w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:outline-none" required>
                    </div>

                    <!-- Ø§Ù„Ø®ÙŠØ§Ø± 4 (Ù…Ø®ÙÙŠ Ù„Ù„Ø£Ø³Ø¦Ù„Ø© True/False) -->
                    <div id="option3Container">
                        <label class="block text-sm font-semibold text-gray-700 mb-2">Ø§Ù„Ø®ÙŠØ§Ø± Ø§Ù„Ø±Ø§Ø¨Ø¹</label>
                        <input type="text" id="option3" name="option3" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ù„Ø®ÙŠØ§Ø± Ø§Ù„Ø±Ø§Ø¨Ø¹..."
                            class="w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:outline-none" required>
                    </div>
                </div>

                <!-- Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© Ø§Ù„ØµØ­ÙŠØ­Ø© -->
                <div>
                    <label class="block text-sm font-semibold text-gray-700 mb-2">Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© Ø§Ù„ØµØ­ÙŠØ­Ø©</label>
                    <select id="correctAnswer" name="correct_answer"
                        class="w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:outline-none" required>
                        <option value="">-- Ø§Ø®ØªØ± Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© Ø§Ù„ØµØ­ÙŠØ­Ø© --</option>
                        <option value="0" id="ansOption0">Ø§Ù„Ø®ÙŠØ§Ø± Ø§Ù„Ø£ÙˆÙ„</option>
                        <option value="1" id="ansOption1">Ø§Ù„Ø®ÙŠØ§Ø± Ø§Ù„Ø«Ø§Ù†ÙŠ</option>
                        <option value="2" id="ansOption2">Ø§Ù„Ø®ÙŠØ§Ø± Ø§Ù„Ø«Ø§Ù„Ø«</option>
                        <option value="3" id="ansOption3">Ø§Ù„Ø®ÙŠØ§Ø± Ø§Ù„Ø±Ø§Ø¨Ø¹</option>
                    </select>
                </div>

                <!-- Ø§Ù„ÙØ¦Ø© -->
                <div>
                    <label class="block text-sm font-semibold text-gray-700 mb-2">Ø§Ù„ÙØ¦Ø©</label>
                    <input type="text" id="category" name="category" placeholder="Ù…Ø«Ø§Ù„: Ø§Ù„Ø­Ø¨ØŒ Ø§Ù„Ø¹Ù„Ø§Ù‚Ø§ØªØŒ Ø§Ù„Ø±ÙˆÙ…Ø§Ù†Ø³ÙŠØ©..."
                        class="w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:outline-none" required>
                </div>

                <!-- Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ -->
                <div class="flex gap-4 pt-4">
                    <button type="submit" id="submitBtn"
                        class="flex-1 btn-primary text-white font-bold py-3 px-4 rounded-lg">
                        ğŸ’¾ Ø­ÙØ¸ Ø§Ù„Ø³Ø¤Ø§Ù„
                    </button>
                    <button type="button" onclick="closeModal()"
                        class="flex-1 bg-gray-300 hover:bg-gray-400 text-gray-800 font-bold py-3 px-4 rounded-lg transition">
                        âŒ Ø¥Ù„ØºØ§Ø¡
                    </button>
                </div>
            </form>
        </div>
    </div>

    <script>
        let questions = [];
        let editingId = null;

        // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø£Ø³Ø¦Ù„Ø©
        async function loadQuestions() {
            try {
                const response = await fetch('/api/questions');
                questions = await response.json();
                renderQuestions();
                updateStats();
            } catch (error) {
                console.error('Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø£Ø³Ø¦Ù„Ø©:', error);
                Swal.fire({
                    icon: 'error',
                    title: 'Ø®Ø·Ø£',
                    text: 'ÙØ´Ù„ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø£Ø³Ø¦Ù„Ø©',
                    confirmButtonColor: '#ec4899'
                });
            }
        }

        // Ø¹Ø±Ø¶ Ø§Ù„Ø£Ø³Ø¦Ù„Ø©
        function renderQuestions() {
            const container = document.getElementById('questionsContainer');

            if (questions.length === 0) {
                container.innerHTML = `
                    <div class="text-center py-12">
                        <p class="text-gray-500 text-lg mb-4">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø£Ø³Ø¦Ù„Ø© Ø­ØªÙ‰ Ø§Ù„Ø¢Ù†</p>
                        <button onclick="openAddModal()" class="btn-primary text-white font-bold py-2 px-6 rounded-lg">
                            â• Ø£Ø¶Ù Ø§Ù„Ø³Ø¤Ø§Ù„ Ø§Ù„Ø£ÙˆÙ„
                        </button>
                    </div>
                `;
                return;
            }

            container.innerHTML = questions.map((q, index) => `
                <div class="question-item rounded-lg p-6 fade-in">
                    <div class="flex flex-col sm:flex-row items-start justify-between gap-4">
                        <div class="flex-1">
                            <div class="flex items-center gap-3 mb-3">
                                <span class="bg-pink-600 text-white rounded-full w-8 h-8 flex items-center justify-center font-bold text-sm">${index + 1}</span>
                                <span class="bg-gray-200 text-gray-700 px-3 py-1 rounded-full text-xs font-semibold">${q.category}</span>
                            </div>
                            <p class="text-gray-800 font-semibold mb-4 text-lg">${q.question}</p>
                            <ul class="space-y-2">
                                ${q.options.map((opt, i) => `
                                    <li class="text-gray-700 ${i === q.correct_answer ? 'font-bold text-green-600' : ''}">
                                        ${i === q.correct_answer ? 'âœ“' : 'â—‹'} ${opt}
                                    </li>
                                `).join('')}
                            </ul>
                        </div>
                        <div class="flex gap-2 sm:flex-col w-full sm:w-auto">
                            <button onclick="editQuestion(${q.id})" class="btn-edit text-white font-bold py-2 px-4 rounded-lg flex-1 sm:flex-none">
                                âœï¸ ØªØ¹Ø¯ÙŠÙ„
                            </button>
                            <button onclick="deleteQuestion(${q.id})" class="btn-danger text-white font-bold py-2 px-4 rounded-lg flex-1 sm:flex-none">
                                ğŸ—‘ï¸ Ø­Ø°Ù
                            </button>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª
        function updateStats() {
            document.getElementById('totalQuestions').textContent = questions.length;
            const categories = new Set(questions.map(q => q.category));
            document.getElementById('totalCategories').textContent = categories.size;
            document.getElementById('lastUpdated').textContent = new Date().toLocaleTimeString('ar-SA');
        }

        // ÙØªØ­ Ù†Ù…ÙˆØ°Ø¬ Ø§Ù„Ø¥Ø¶Ø§ÙØ©
        function openAddModal() {
            editingId = null;
            document.getElementById('modalTitle').textContent = 'Ø¥Ø¶Ø§ÙØ© Ø³Ø¤Ø§Ù„ Ø¬Ø¯ÙŠØ¯';
            document.getElementById('questionForm').reset();
            document.getElementById('submitBtn').textContent = 'ğŸ’¾ Ø­ÙØ¸ Ø§Ù„Ø³Ø¤Ø§Ù„';
            document.getElementById('questionModal').classList.add('active');
            document.getElementById('questionText').focus();
            resetQuestionType();
        }

        // ØªØ­Ø¯ÙŠØ« Ù†ÙˆØ¹ Ø§Ù„Ø³Ø¤Ø§Ù„
        function updateQuestionType() {
            const type = document.getElementById('questionType').value;
            const option2Container = document.getElementById('option2Container');
            const option3Container = document.getElementById('option3Container');
            const ansOption2 = document.getElementById('ansOption2');
            const ansOption3 = document.getElementById('ansOption3');
            const option2 = document.getElementById('option2');
            const option3 = document.getElementById('option3');

            if (type === 'tf') {
                // Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ø®ÙŠØ§Ø±Ø§Øª 3 Ùˆ 4
                option2Container.style.display = 'none';
                option3Container.style.display = 'none';
                ansOption2.style.display = 'none';
                ansOption3.style.display = 'none';

                // ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ø®ÙŠØ§Ø±Ø§Øª ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹
                document.getElementById('option0').value = 'ØµØ­';
                document.getElementById('option1').value = 'Ø®Ø·Ø£';
                option2.removeAttribute('required');
                option3.removeAttribute('required');
            } else if (type === 'mcq') {
                // Ø¥Ø¸Ù‡Ø§Ø± Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø®ÙŠØ§Ø±Ø§Øª
                option2Container.style.display = 'block';
                option3Container.style.display = 'block';
                ansOption2.style.display = 'block';
                ansOption3.style.display = 'block';
                option2.setAttribute('required', 'required');
                option3.setAttribute('required', 'required');

                // Ù…Ø³Ø­ Ø§Ù„Ù‚ÙŠÙ… Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠØ©
                document.getElementById('option0').value = '';
                document.getElementById('option1').value = '';
            }
        }

        // Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ù†ÙˆØ¹ Ø§Ù„Ø³Ø¤Ø§Ù„
        function resetQuestionType() {
            document.getElementById('questionType').value = '';
            document.getElementById('option2Container').style.display = 'block';
            document.getElementById('option3Container').style.display = 'block';
            document.getElementById('ansOption2').style.display = 'block';
            document.getElementById('ansOption3').style.display = 'block';
            document.getElementById('option2').setAttribute('required', 'required');
            document.getElementById('option3').setAttribute('required', 'required');
        }

        // ØªØ­Ø±ÙŠØ± Ø³Ø¤Ø§Ù„
        function editQuestion(id) {
            const question = questions.find(q => q.id === id);
            if (!question) return;

            editingId = id;
            document.getElementById('modalTitle').textContent = 'ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø³Ø¤Ø§Ù„';
            document.getElementById('questionType').value = question.type || 'mcq';
            updateQuestionType();
            document.getElementById('questionText').value = question.question;
            document.getElementById('option0').value = question.options[0];
            document.getElementById('option1').value = question.options[1];
            if (question.options[2]) document.getElementById('option2').value = question.options[2];
            if (question.options[3]) document.getElementById('option3').value = question.options[3];
            document.getElementById('correctAnswer').value = question.correct_answer;
            document.getElementById('category').value = question.category;
            document.getElementById('submitBtn').textContent = 'ğŸ’¾ ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø³Ø¤Ø§Ù„';
            document.getElementById('questionModal').classList.add('active');
        }

        // Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ù†Ù…ÙˆØ°Ø¬
        function closeModal() {
            document.getElementById('questionModal').classList.remove('active');
            editingId = null;
        }

        // Ù…Ø¹Ø§Ù„Ø¬Ø© Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ù†Ù…ÙˆØ°Ø¬
        async function handleFormSubmit(event) {
            event.preventDefault();

            const type = document.getElementById('questionType').value;
            if (!type) {
                Swal.fire({
                    icon: 'warning',
                    title: 'Ø§Ø®ØªØ± Ù†ÙˆØ¹ Ø§Ù„Ø³Ø¤Ø§Ù„',
                    text: 'ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ù†ÙˆØ¹ Ø§Ù„Ø³Ø¤Ø§Ù„ Ø£ÙˆÙ„Ø§Ù‹!',
                    confirmButtonColor: '#ec4899'
                });
                return;
            }

            const options = type === 'tf'
                ? [document.getElementById('option0').value, document.getElementById('option1').value]
                : [
                    document.getElementById('option0').value,
                    document.getElementById('option1').value,
                    document.getElementById('option2').value,
                    document.getElementById('option3').value
                ];

            const data = {
                type: type,
                question: document.getElementById('questionText').value,
                options: options,
                correct_answer: parseInt(document.getElementById('correctAnswer').value),
                category: document.getElementById('category').value
            };

            try {
                let response;
                if (editingId) {
                    response = await fetch(`/api/admin/update-question/${editingId}`, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(data)
                    });
                } else {
                    response = await fetch('/api/admin/add-question', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(data)
                    });
                }

                if (response.ok) {
                    closeModal();
                    loadQuestions();
                    Swal.fire({
                        icon: 'success',
                        title: 'Ù†Ø¬Ø­!',
                        text: editingId ? 'ØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø³Ø¤Ø§Ù„ Ø¨Ù†Ø¬Ø§Ø­' : 'ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø³Ø¤Ø§Ù„ Ø¨Ù†Ø¬Ø§Ø­',
                        confirmButtonColor: '#ec4899'
                    });
                } else {
                    throw new Error('ÙØ´Ù„ Ø§Ù„Ø­ÙØ¸');
                }
            } catch (error) {
                console.error('Ø®Ø·Ø£:', error);
                Swal.fire({
                    icon: 'error',
                    title: 'Ø®Ø·Ø£',
                    text: 'ÙØ´Ù„ Ø­ÙØ¸ Ø§Ù„Ø³Ø¤Ø§Ù„. ÙŠØ±Ø¬Ù‰ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù…Ø±Ø© Ø£Ø®Ø±Ù‰.',
                    confirmButtonColor: '#ec4899'
                });
            }
        }

        // Ø­Ø°Ù Ø³Ø¤Ø§Ù„
        async function deleteQuestion(id) {
            const confirmed = await Swal.fire({
                title: 'Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ØŸ',
                text: 'Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„ØªØ±Ø§Ø¬Ø¹ Ø¹Ù† Ù‡Ø°Ø§ Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡!',
                icon: 'warning',
                showCancelButton: true,
                confirmButtonColor: '#f43f5e',
                cancelButtonColor: '#ec4899',
                confirmButtonText: 'âœ“ Ù†Ø¹Ù…ØŒ Ø§Ø­Ø°ÙÙ‡',
                cancelButtonText: 'Ø¥Ù„ØºØ§Ø¡'
            });

            if (!confirmed.isConfirmed) return;

            try {
                const response = await fetch(`/api/admin/delete-question/${id}`, { method: 'DELETE' });
                if (response.ok) {
                    loadQuestions();
                    Swal.fire({
                        icon: 'success',
                        title: 'ØªÙ… Ø§Ù„Ø­Ø°Ù!',
                        text: 'ØªÙ… Ø­Ø°Ù Ø§Ù„Ø³Ø¤Ø§Ù„ Ø¨Ù†Ø¬Ø§Ø­',
                        confirmButtonColor: '#ec4899'
                    });
                } else {
                    throw new Error('ÙØ´Ù„ Ø§Ù„Ø­Ø°Ù');
                }
            } catch (error) {
                console.error('Ø®Ø·Ø£:', error);
                Swal.fire({
                    icon: 'error',
                    title: 'Ø®Ø·Ø£',
                    text: 'ÙØ´Ù„ Ø­Ø°Ù Ø§Ù„Ø³Ø¤Ø§Ù„. ÙŠØ±Ø¬Ù‰ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù…Ø±Ø© Ø£Ø®Ø±Ù‰.',
                    confirmButtonColor: '#ec4899'
                });
            }
        }

        // Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ Ø¹Ù†Ø¯ Ø§Ù„Ù†Ù‚Ø± Ø¹Ù„Ù‰ Ø§Ù„Ø®Ù„ÙÙŠØ©
        document.getElementById('questionModal').addEventListener('click', function (event) {
            if (event.target === this) {
                closeModal();
            }
        });

        // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø£Ø³Ø¦Ù„Ø© Ø¹Ù†Ø¯ ÙØªØ­ Ø§Ù„ØµÙØ­Ø©
        window.addEventListener('DOMContentLoaded', loadQuestions);
    </script>
</body>

</html>